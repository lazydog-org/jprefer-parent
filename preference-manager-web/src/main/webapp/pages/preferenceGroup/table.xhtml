<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
                      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:a4j="http://richfaces.org/a4j"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:rich="http://richfaces.org/rich"
    xmlns:ui="http://java.sun.com/jsf/facelets">
    <head/>
    <body>
        <ui:composition>
            <h:form id="pm-preference-group-table">
                <div class="pm-form-buttons">
                    <a4j:commandButton
                        value="Add"
                        actionListener="#{preferenceGroupMB.processAddButton}"
                        oncomplete="Richfaces.showModalPanel('pm-preference-group-modal-panel');"
                        reRender="pm-preference-group-modal-panel-content"/>
                </div>
                <rich:tree
                    switchType="ajax">
                    <rich:recursiveTreeNodesAdaptor
                        roots="#{preferenceGroupMB.preferenceGroupTrees}"
                        var="preferenceGroup"
                        nodes="#{preferenceGroup.children}">
                        <rich:treeNodesAdaptor 
                            var="preference"
                            nodes="#{preferenceGroup.preferences}"/>
                        <rich:treeNode
                            id="pm-preference-group-tree-node"
                            icon="/images/iconFolder.gif"
                            iconLeaf="/images/iconFolder.gif">
                            <h:outputText value="#{preferenceGroup}"/>
                            <rich:contextMenu
                                attachTo="pm-preference-group-tree-node"
                                submitMode="ajax">
                                <rich:menuItem
                                    value="Add"
                                    actionListener="#{preferenceGroupMB.processAddButton}"
                                    oncomplete="Richfaces.showModalPanel('pm-preference-group-modal-panel');"
                                    reRender="pm-preference-group-modal-panel-content"/>
                                <rich:menuItem
                                    value="Delete"
                                    reRender="pm-preference-group-table">
                                    <a4j:actionparam
                                        name="absolutePath"
                                        assignTo="#{preferenceGroupMB.absolutePath}"
                                        value="#{preferenceGroup.absolutePath}"
                                        actionListener="#{preferenceGroupMB.processDeleteButton}"/>
                                </rich:menuItem>
                                <rich:menuItem
                                    value="Modify"
                                    oncomplete="Richfaces.showModalPanel('pm-preference-group-modal-panel');"
                                    reRender="pm-preference-group-modal-panel-content">
                                    <a4j:actionparam
                                        name="absolutePath"
                                        assignTo="#{preferenceGroupMB.absolutePath}"
                                        value="#{preferenceGroup.absolutePath}"
                                        actionListener="#{preferenceGroupMB.processModifyButton}"/>
                                </rich:menuItem>
                            </rich:contextMenu>
                        </rich:treeNode>
                    </rich:recursiveTreeNodesAdaptor>
                </rich:tree>
            </h:form>
        </ui:composition>
    </body>
</html>
