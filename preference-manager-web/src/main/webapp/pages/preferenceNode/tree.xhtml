<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
                      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:a4j="http://richfaces.org/a4j"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:rich="http://richfaces.org/rich"
    xmlns:ui="http://java.sun.com/jsf/facelets">
    <head/>
    <body>
        <ui:composition>
            <h:form id="pm-preference-node-tree">
                <rich:tree
                    switchType="ajax">
                    <rich:recursiveTreeNodesAdaptor
                        roots="#{preferenceNodeMB.rootNodes}"
                        var="preferenceNode"
                        nodes="#{preferenceNode.children}">
                        <rich:treeNodesAdaptor 
                            var="preference"
                            nodes="#{preferenceNode.preferences}"/>
                        <rich:treeNode
                            id="pm-preference-node-tree-node"
                            icon="/images/iconFolder.gif"
                            iconLeaf="/images/iconFolder.gif">
                            <h:outputText value="#{preferenceNode}"/>
                            <rich:contextMenu
                                attachTo="pm-preference-node-tree-node"
                                submitMode="ajax">
                                <rich:menuItem
                                    value="Add"
                                    actionListener="#{preferenceNodeMB.processAddButton}"
                                    oncomplete="Richfaces.showModalPanel('pm-preference-node-modal-panel');"
                                    reRender="pm-preference-node-modal-panel-content"/>
                                <rich:menuItem
                                    value="Delete"
                                    actionListener="#{preferenceNodeMB.processDeleteButton}"
                                    reRender="pm-preference-node-tree"/>
                                <rich:menuItem
                                    value="Modify"
                                    oncomplete="Richfaces.showModalPanel('pm-preference-node-modal-panel');"
                                    reRender="pm-preference-node-modal-panel-content">
                                    <a4j:actionparam
                                        name="absolutePath"
                                        assignTo="#{preferenceNodeMB.absolutePath}"
                                        value="#{preferenceNode.absolutePath}"
                                        actionListener="#{preferenceNodeMB.processModifyButton}"/>
                                </rich:menuItem>
                            </rich:contextMenu>
                        </rich:treeNode>
                    </rich:recursiveTreeNodesAdaptor>
                </rich:tree>
            </h:form>
        </ui:composition>
    </body>
</html>
